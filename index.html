<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ðŸŽ‚ Happy 20th Birthday</title>

  <style>
    :root { color-scheme: dark; }
    * { box-sizing: border-box; }

    body{
      margin:0; min-height:100vh;
      display:grid; place-items:center;
      background: radial-gradient(circle at top, #2a1b3d, #0b0b12 60%, #000);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color:#fff;
      padding: 18px;
    }

    /* ===== Layout ===== */
    .layout{
      width: min(1200px, 96vw);
      display:grid;
      grid-template-columns: 240px 1fr 240px;
      gap: 18px;
      align-items: start;
    }

    @media (max-width: 980px){
      .layout{ grid-template-columns: 1fr; }
      .side{
        order: 2;
        display:grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 12px;
      }
      .card{ order: 1; }
    }

    /* ===== Card ===== */
    .card{
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.14);
      border-radius: 22px;
      padding: 18px;
      box-shadow: 0 20px 60px rgba(0,0,0,.55);
    }

    h1{
      margin:8px 6px 10px;
      font-size: clamp(26px, 3.2vw, 38px);
    }
    p{ margin:0 6px 14px; opacity:.9; line-height:1.45; }

    /* ===== Video frame (FIXED SIZE) =====
       This keeps the whole screen/card stable.
       You can change 16/9 if you want a taller box.
    */
    .wrap{
      position: relative;
      border-radius: 18px;
      overflow:hidden;
      background:#000;
      width:100%;
      aspect-ratio: 16 / 9; /* FIXED - does NOT change */
    }

    /* Video keeps ORIGINAL ratio (no crop, no stretch) */
    video{
      width:100%;
      height:100%;
      display:block;
      object-fit: contain; /* preserves original video format */
      background:#000;     /* letterbox bars if needed */
    }

    /* ===== Overlay ===== */
    .overlay{
      position:absolute; inset:0;
      display:grid; place-items:center;
      background: linear-gradient(to bottom, rgba(0,0,0,.35), rgba(0,0,0,.82));
      backdrop-filter: blur(2px);
      transition: opacity .3s ease;
      padding: 18px;
      user-select:none;
    }
    .overlay.hidden{ opacity:0; pointer-events:none; }

    .overlay-inner{
      width: min(660px, 94%);
      text-align:center;
      display:grid;
      gap: 12px;
      place-items:center;
    }

    /* ===== Cake hint ===== */
    .hint{
      font-weight:800;
      letter-spacing:.6px;
      text-transform: uppercase;
      opacity:.95;
      display:flex;
      align-items:center;
      gap: 12px;
      white-space: nowrap;
      pointer-events:none;
    }
    .arrow{
      width: 78px;
      height: 2px;
      background: rgba(255,255,255,.65);
      position: relative;
      border-radius: 4px;
    }
    .arrow:after{
      content:"";
      position:absolute; top: 50%;
      width: 10px; height: 10px;
      border-right: 2px solid rgba(255,255,255,.65);
      border-bottom: 2px solid rgba(255,255,255,.65);
      transform: translateY(-50%) rotate(-45deg);
      right: -2px;
    }
    .arrow.left:after{
      left: -2px; right:auto;
      transform: translateY(-50%) rotate(135deg);
    }
    .hint-bubble{
      padding: 8px 12px;
      border-radius: 999px;
      background: rgba(0,0,0,.35);
      border: 1px solid rgba(255,255,255,.16);
    }

    /* ===== Cake ===== */
    .cake-btn{
      background:none;
      border:0;
      cursor:pointer;
      padding:0;
      -webkit-tap-highlight-color: transparent;
    }

    .cake{
      width:320px; height:200px;
      position:relative;
      filter: drop-shadow(0 18px 40px rgba(0,0,0,.55));
      transition: transform .4s ease, opacity .4s ease;
    }
    .plate{
      position:absolute; bottom:0; left:50%;
      transform:translateX(-50%);
      width:340px; height:34px;
      background:rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.12);
      border-radius:999px;
    }
    .base{
      position:absolute; bottom:28px; left:50%;
      transform:translateX(-50%);
      width:300px; height:120px;
      background:linear-gradient(180deg,#ffd36a,#ffa048);
      border:1px solid rgba(255,255,255,.18);
      border-radius:20px 20px 26px 26px;
    }
    .icing{
      position:absolute; bottom:118px; left:50%;
      transform:translateX(-50%);
      width:280px; height:70px;
      background:linear-gradient(180deg,#fff,#eee);
      border:1px solid rgba(255,255,255,.18);
      border-radius:26px 26px 18px 18px;
    }

    .candles{
      position:absolute; bottom:160px; left:50%;
      transform:translateX(-50%);
      display:flex; gap:14px;
    }
    .candle{
      width:14px; height:52px;
      background: linear-gradient(180deg, rgba(255,120,180,.95), rgba(255,70,140,.9));
      border-radius:8px;
      position:relative;
      border:1px solid rgba(255,255,255,.18);
    }
    .candle:nth-child(2){
      background: linear-gradient(180deg, rgba(120,200,255,.95), rgba(70,150,255,.9));
    }
    .candle:nth-child(3){
      background: linear-gradient(180deg, rgba(160,255,160,.95), rgba(80,210,120,.9));
    }
    .wick{
      position:absolute; left:50%; top:-8px;
      width:2px; height:10px;
      transform:translateX(-50%);
      background: rgba(40,40,40,.9);
      border-radius:2px;
    }
    .flame{
      position:absolute; top:-28px; left:50%;
      transform:translateX(-50%);
      width:18px; height:26px;
      background: radial-gradient(circle at 50% 35%, #fff5c8, #ff9c2a 55%, #ff5a00 80%);
      border-radius:50%;
      filter: drop-shadow(0 0 14px rgba(255,190,60,.45));
      animation:flicker 1.05s infinite ease-in-out;
      transform-origin: 50% 90%;
    }
    @keyframes flicker{
      0%{transform:translateX(-50%) scale(1) rotate(-2deg); opacity:.95;}
      50%{transform:translateX(-50%) scale(1.06) rotate(2deg); opacity:1;}
      100%{transform:translateX(-50%) scale(1) rotate(0deg); opacity:.96;}
    }

    /* blown state */
    .overlay.blown .flame{
      animation:none;
      opacity:0;
      transform: translateX(-50%) scale(.2);
      transition: opacity .18s ease, transform .18s ease;
    }
    .overlay.blown .cake{
      opacity:0;
      transform: translateY(18px) scale(.98);
    }

    /* ===== Message after blowing ===== */
    .message{
      display:none;
      text-align:center;
      line-height: 1.55;
      font-size: 16px;
      opacity: .95;
      padding: 10px 8px;
      white-space: pre-line;
    }
    .overlay.show-message .message{ display:block; }
    .overlay.show-message .cake-ui{ display:none; }

    .countdown{
      font-size: 13px;
      opacity: .8;
      margin-top: 10px;
    }

    /* ===== Side photos ===== */
    .side{ display:flex; flex-direction:column; gap:12px; }
    .photo-box{
      height:140px;
      border-radius:18px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.05);
      box-shadow: 0 16px 40px rgba(0,0,0,.45);
    }
    .photo-box img{
      width:100%; height:100%;
      object-fit:cover;
      display:block;
      transition:opacity .25s ease;
    }
    .fade-out{ opacity:0; }
  </style>
</head>

<body>
  <div class="layout">

    <!-- Left photos -->
    <aside class="side" aria-label="Left photos">
      <div class="photo-box"><img id="L0" src="photo01.jpg" alt="Left photo 1"></div>
      <div class="photo-box"><img id="L1" src="photo02.jpg" alt="Left photo 2"></div>
      <div class="photo-box"><img id="L2" src="photo03.jpg" alt="Left photo 3"></div>
    </aside>

    <!-- Center -->
    <main class="card">
      <h1>ðŸŽ‰ Happy 20th Birthday!</h1>
      <p>Make a wish, then blow the candles to start ðŸŽ‚</p>

      <section class="wrap" id="videoWrap">
        <video id="video" playsinline preload="metadata" controls>
          <source src="video.mp4" type="video/mp4">
          Your browser does not support the video tag.
        </video>

        <div id="overlay" class="overlay">
          <div class="overlay-inner">

            <!-- Cake UI -->
            <div class="cake-ui">
              <div class="hint" aria-hidden="true">
                <span class="arrow left"></span>
                <span class="hint-bubble">CLICK â€¢ BLOW ME</span>
                <span class="arrow"></span>
              </div>

              <button id="cakeBtn" class="cake-btn" aria-label="Blow the candles">
                <div class="cake">
                  <div class="candles">
                    <div class="candle"><div class="wick"></div><div class="flame"></div></div>
                    <div class="candle"><div class="wick"></div><div class="flame"></div></div>
                    <div class="candle"><div class="wick"></div><div class="flame"></div></div>
                  </div>
                  <div class="icing"></div>
                  <div class="base"></div>
                  <div class="plate"></div>
                </div>
              </button>

              <div style="font-size:13px; opacity:.85; margin-top:8px;">
                Tap the cake to blow the candles.
              </div>
            </div>

            <!-- Message UI -->
            <div class="message" id="message">
Il mare piÃ¹ bello;
Ã¨ quello in cui non siamo ancora andati.
Il bambino piÃ¹ bello;
non Ã¨ ancora cresciuto.
I nostri giorni piÃ¹ belli;
sono quelli che non abbiamo ancora vissuto.

Buon compleanno,
a un futuro pieno di salute e felicitÃ .
              <div class="countdown" id="countdown">Starting the video in 10sâ€¦</div>
            </div>

          </div>
        </div>
      </section>
    </main>

    <!-- Right photos -->
    <aside class="side" aria-label="Right photos">
      <div class="photo-box"><img id="R0" src="photo04.jpg" alt="Right photo 1"></div>
      <div class="photo-box"><img id="R1" src="photo05.jpg" alt="Right photo 2"></div>
      <div class="photo-box"><img id="R2" src="photo06.jpg" alt="Right photo 3"></div>
    </aside>

  </div>

  <script>
    /* ===== Cake â†’ show message â†’ wait 10s â†’ start video ===== */
    const cakeBtn = document.getElementById("cakeBtn");
    const overlay = document.getElementById("overlay");
    const video = document.getElementById("video");
    const countdownEl = document.getElementById("countdown");

    let started = false;
    let countdownTimer = null;

    async function startVideoNow(){
      try { await video.play(); } catch(e) {}
      overlay.classList.add("hidden");
      video.focus?.();
    }

    function clearCountdown(){
      if (countdownTimer) {
        clearInterval(countdownTimer);
        countdownTimer = null;
      }
    }

    cakeBtn.addEventListener("click", () => {
      if (started) return;
      started = true;

      overlay.classList.add("blown");

      setTimeout(() => {
        overlay.classList.add("show-message");

        let t = 10;
        countdownEl.textContent = `Starting the video in ${t}sâ€¦`;

        clearCountdown();
        countdownTimer = setInterval(() => {
          t -= 1;
          if (t <= 0) {
            clearCountdown();
            countdownEl.textContent = "Startingâ€¦";
            startVideoNow();
          } else {
            countdownEl.textContent = `Starting the video in ${t}sâ€¦`;
          }
        }, 1000);
      }, 450);
    });

    video.addEventListener("play", () => overlay.classList.add("hidden"));

    video.addEventListener("ended", () => {
      clearCountdown();
      started = false;
      overlay.classList.remove("hidden");
      overlay.classList.remove("blown");
      overlay.classList.remove("show-message");
    });

    /* ===== Side photo rotation (20 photos, 1 second step) ===== */
    const TOTAL = 20;
    const photos = Array.from({length:TOTAL},(_,i)=>`photo${String(i+1).padStart(2,"0")}.jpg`);
    photos.forEach(src => { const img = new Image(); img.src = src; });

    const leftEls  = [L0, L1, L2];
    const rightEls = [R0, R1, R2];

    let a = 0, b = 3;

    function swapWithFade(imgEl, newSrc){
      imgEl.classList.add("fade-out");
      setTimeout(() => {
        imgEl.src = newSrc;
        imgEl.classList.remove("fade-out");
      }, 220);
    }

    setInterval(() => {
      for (let i = 0; i < 3; i++){
        swapWithFade(leftEls[i],  photos[(a+i) % TOTAL]);
        swapWithFade(rightEls[i], photos[(b+i) % TOTAL]);
      }
      a = (a + 1) % TOTAL;
      b = (b + 1) % TOTAL;
    }, 1000);
  </script>
</body>
</html>
